{% extends 'MaestroCoreBundle::default.html.twig' %}

{% block body %}
{{ form_start(form) }}
 <div class="page-header position-relative">
  <h1>Solicitud para agregar establecimiento <small>  <i class="icon-double-angle-right"></i> info adicional </small></h1>
</div>
<div class="row-fluid">
  <div class="span12">
    <div class="widget-box">
      <div class="widget-header widget-header-blue widget-header-flat">
      </div>

      <div class="widget-body">
        <div class="widget-main">
          <div class="row-fluid">
            <div id="fuelux-wizard" class="row-fluid hide" data-target="#step-container">
            <ul class="wizard-steps">
              <li data-target="#step1" class="active">
                <span class="step">1</span>
                <span class="title">Datos generales</span>
              </li>

              <li data-target="#step2">
                <span class="step">2</span>
                <span class="title">Localizaci√≥n</span>
              </li>

              <li data-target="#step3">
                <span class="step">3</span>
                <span class="title">Datos administrativos</span>
              </li>

              <li data-target="#step4">
                <span class="step">4</span>
                <span class="title">Recurso Humano y servicios</span>
              </li>
            </ul>
            </div>

            <hr />
            <div class="step-content row-fluid position-relative" id="step-container">
              <div class="step-pane active" id="step1"><div class="control-group warning">
               <div class="control-group ">{{ form_label(form.nombre) }}
                <div class="controls"><span class="span12 input-icon input-icon-right">{{ form_widget(form.nombre) }}</span>{{ form_errors(form.nombre) }}</div>
               </div>
               <div class="control-group ">{{ form_label(form.direccion) }}
                <div class="controls"><span class="span12 input-icon input-icon-right">{{ form_widget(form.direccion) }}</span>{{ form_errors(form.direccion) }}</div>
               </div>
               <div class="control-group ">{{ form_label(form.telefono) }}
                <div class="controls"><span class="span12 input-icon input-icon-right">{{ form_widget(form.telefono) }}</span>{{ form_errors(form.telefono) }}</div>
               </div>
               <div class="control-group ">{{ form_label(form.fax) }}
                <div class="controls"><span class="span12 input-icon input-icon-right">{{ form_widget(form.fax) }}</span>{{ form_errors(form.fax) }}</div>
               </div>
               <div class="control-group ">{{ form_label(form.anioApertura) }}
                <div class="controls"><span class="span12 input-icon input-icon-right">{{ form_widget(form.anioApertura) }}</span>{{ form_errors(form.anioApertura) }}</div>
               </div>
               <div class="control-group ">{{ form_label(form.activo) }}
                <div class="controls"><span class="span12 input-icon input-icon-right">{{ form_widget(form.activo) }}</span>{{ form_errors(form.activo) }}</div>
               </div>
              </div>

              <div class="step-pane" id="step2">
              <div class="control-group ">{{ form_label(form.latitud) }}
               <div class="controls"><span class="span12 input-icon input-icon-right">{{ form_widget(form.latitud) }}</span>{{ form_errors(form.latitud) }}</div>
              </div>
              <div class="control-group ">{{ form_label(form.longitud) }}
               <div class="controls"><span class="span12 input-icon input-icon-right">{{ form_widget(form.longitud) }}</span>{{ form_errors(form.longitud) }}</div>
              </div>
              <div class="control-group ">{{ form_label(form.cabezaMicrored) }}
               <div class="controls"><span class="span12 input-icon input-icon-right">{{ form_widget(form.cabezaMicrored) }}</span>{{ form_errors(form.cabezaMicrored) }}</div>
              </div>
              <div class="control-group ">{{ form_label(form.idMunicipio) }}
               <div class="controls"><span class="span12 input-icon input-icon-right">{{ form_widget(form.idMunicipio) }}</span>{{ form_errors(form.idMunicipio) }}</div>
              </div>
              </div>

              <div class="step-pane" id="step3">
              <div class="control-group ">{{ form_label(form.hospitalizacion) }}
               <div class="controls"><span class="span12 input-icon input-icon-right">{{ form_widget(form.hospitalizacion) }}</span>{{ form_errors(form.hospitalizacion) }}</div>
              </div>
              <div class="control-group ">{{ form_label(form.detalleSchema) }}
               <div class="controls"><span class="span12 input-icon input-icon-right">{{ form_widget(form.detalleSchema) }}</span>{{ form_errors(form.detalleSchema) }}</div>
              </div>
              <div class="control-group ">{{ form_label(form.idmicrored) }}
               <div class="controls"><span class="span12 input-icon input-icon-right">{{ form_widget(form.idmicrored) }}</span>{{ form_errors(form.idmicrored) }}</div>
              </div>
              <div class="control-group ">{{ form_label(form.idEstablecimientoPadre) }}
               <div class="controls"><span class="span12 input-icon input-icon-right">{{ form_widget(form.idEstablecimientoPadre) }}</span>{{ form_errors(form.idEstablecimientoPadre) }}</div>
              </div>
              <div class="control-group ">{{ form_label(form.idTipoEstablecimiento) }}
               <div class="controls"><span class="span12 input-icon input-icon-right">{{ form_widget(form.idTipoEstablecimiento) }}</span>{{ form_errors(form.idTipoEstablecimiento) }}</div>
              </div>
              <div class="control-group ">{{ form_label(form.detalleSchema) }}
               <div class="controls"><span class="span12 input-icon input-icon-right">{{ form_widget(form.detalleSchema) }}</span>{{ form_errors(form.detalleSchema) }}</div>
              </div>
              </div>

              <div class="step-pane" id="step4">
            </div>

            <hr />
            <div class="row-fluid wizard-actions">
              <button class="btn btn-prev">
                <i class="icon-arrow-left"></i>
                Anterior
              </button>

              <button class="btn btn-success btn-next" data-last="Finish ">
                Siguiente
                <i class="icon-arrow-right icon-on-right"></i>
              </button>
            </div>
          </div>
        </div><!--/widget-main-->
      </div><!--/widget-body-->
    </div>
  </div>
</div>

							<div id="modal-wizard" class="modal hide">
							</div>
<a href="{{ path('establecimiento_index', {'type': 2}) }}" class="btn btn-prev">Regresar al listado</a>
    {{ form_end(form) }}
{% endblock %}

{% block footer_js %}
 <!--page specific plugin scripts-->
 <script src="{{ asset('assets/') }}js/fuelux/fuelux.wizard.min.js"></script>
 <script src="{{ asset('assets/') }}js/jquery.validate.min.js"></script>
 <script src="{{ asset('assets/') }}js/additional-methods.min.js"></script>
 <script src="{{ asset('assets/') }}js/bootbox.min.js"></script>
 <script src="{{ asset('assets/') }}js/jquery.maskedinput.min.js"></script>
 <script src="{{ asset('assets/') }}js/select2.min.js"></script>


 		<script type="text/javascript">
 			$(function() {

 				$('[data-rel=tooltip]').tooltip();

 				$(".select2").css('width','150px').select2({allowClear:true})
 				.on('change', function(){
 					$(this).closest('form').validate().element($(this));
 				});


 				var $validation = false;
 				$('#fuelux-wizard').ace_wizard().on('change' , function(e, info){
 					if(info.step == 1 && $validation) {
 						if(!$('#validation-form').valid()) return false;
 					}
 				}).on('finished', function(e) {
 					bootbox.dialog("Thank you! Your information was successfully saved!", [{
 						"label" : "OK",
 						"class" : "btn-small btn-primary",
 						}]
 					);
 				}).on('stepclick', function(e){
 					//return false;//prevent clicking on steps
 				});


 				$('#validation-form').hide();
 				$('#skip-validation').removeAttr('checked').on('click', function(){
 					$validation = this.checked;
 					if(this.checked) {
 						$('#sample-form').hide();
 						$('#validation-form').show();
 					}
 					else {
 						$('#validation-form').hide();
 						$('#sample-form').show();
 					}
 				});



 				//documentation : http://docs.jquery.com/Plugins/Validation/validate


 				$.mask.definitions['~']='[+-]';
 				$('#phone').mask('(999) 999-9999');

 				jQuery.validator.addMethod("phone", function (value, element) {
 					return this.optional(element) || /^\(\d{3}\) \d{3}\-\d{4}( x\d{1,6})?$/.test(value);
 				}, "Enter a valid phone number.");

 				$('#validation-form').validate({
 					errorElement: 'span',
 					errorClass: 'help-inline',
 					focusInvalid: false,
 					rules: {
 						email: {
 							required: true,
 							email:true
 						},
 						password: {
 							required: true,
 							minlength: 5
 						},
 						password2: {
 							required: true,
 							minlength: 5,
 							equalTo: "#password"
 						},
 						name: {
 							required: true
 						},
 						phone: {
 							required: true,
 							phone: 'required'
 						},
 						url: {
 							required: true,
 							url: true
 						},
 						comment: {
 							required: true
 						},
 						state: {
 							required: true
 						},
 						platform: {
 							required: true
 						},
 						subscription: {
 							required: true
 						},
 						gender: 'required',
 						agree: 'required'
 					},

 					messages: {
 						email: {
 							required: "Please provide a valid email.",
 							email: "Please provide a valid email."
 						},
 						password: {
 							required: "Please specify a password.",
 							minlength: "Please specify a secure password."
 						},
 						subscription: "Please choose at least one option",
 						gender: "Please choose gender",
 						agree: "Please accept our policy"
 					},

 					invalidHandler: function (event, validator) { //display error alert on form submit
 						$('.alert-error', $('.login-form')).show();
 					},

 					highlight: function (e) {
 						$(e).closest('.control-group').removeClass('info').addClass('error');
 					},

 					success: function (e) {
 						$(e).closest('.control-group').removeClass('error').addClass('info');
 						$(e).remove();
 					},

 					errorPlacement: function (error, element) {
 						if(element.is(':checkbox') || element.is(':radio')) {
 							var controls = element.closest('.controls');
 							if(controls.find(':checkbox,:radio').length > 1) controls.append(error);
 							else error.insertAfter(element.nextAll('.lbl:eq(0)').eq(0));
 						}
 						else if(element.is('.select2')) {
 							error.insertAfter(element.siblings('[class*="select2-container"]:eq(0)'));
 						}
 						else if(element.is('.chzn-select')) {
 							error.insertAfter(element.siblings('[class*="chzn-container"]:eq(0)'));
 						}
 						else error.insertAfter(element);
 					},

 					submitHandler: function (form) {
 					},
 					invalidHandler: function (form) {
 					}
 				});
 				$('#modal-wizard .modal-header').ace_wizard();
 				$('#modal-wizard .wizard-actions .btn[data-dismiss=modal]').removeAttr('disabled');
 			})
 		</script>
{% endblock %}
